{% load static %}
<!DOCTYPE html>
<html lang="en">

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=0.2">
  <meta name="description"
    content="Cuba admin is super flexible, powerful, clean &amp; modern responsive bootstrap 5 admin template with unlimited possibilities.">
  <meta name="keywords"
    content="admin template, Cuba admin template, dashboard template, flat admin template, responsive admin template, web app">
  <meta name="author" content="pixelstrap">
  <link rel="icon" href="../assets/images/favicon.png" type="image/x-icon">
  <link rel="shortcut icon" href="../assets/images/favicon.png" type="image/x-icon">
  <title>Outbox:Ticketing</title>
  <!-- Google font-->
  <link href="https://fonts.googleapis.com/css?family=Rubik:400,400i,500,500i,700,700i&amp;display=swap"
    rel="stylesheet">
  <link href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,500,500i,700,700i,900&amp;display=swap"
    rel="stylesheet">
  <link rel="stylesheet" type="text/css" href="{% static 'assets/css/font-awesome.css'%}">


  <!-- ico-font-->
  <link rel="stylesheet" type="text/css" href="{% static 'assets/css/vendors/icofont.css'%}">
  <!-- Themify icon-->
  <link rel="stylesheet" type="text/css" href="{% static 'assets/css/vendors/themify.css'%}">

  <!-- Flag icon-->
  <link rel="stylesheet" type="text/css" href="{% static 'assets/css/vendors/flag-icon.css'%}">

  <!-- Feather icon-->
  <link rel="stylesheet" type="text/css" href="{% static 'assets/css/vendors/feather-icon.css'%}">
  <!-- Plugins css start-->
  <link rel="stylesheet" type="text/css" href="{% static 'assets/css/vendors/scrollbar.css'%}">
  <link rel="stylesheet" type="text/css" href="{% static 'assets/css/vendors/animate.css'%}">
  <link rel="stylesheet" type="text/css" href="{% static 'assets/css/vendors/jkanban.css'%}">


  <!-- <link rel="stylesheet" type="text/css" href="{% static 'assets/css/vendors/sweetalert2.css'%}"> -->
  <link rel="stylesheet" type="text/css" href="{% static 'assets/css/vendors/custom/sweetalert/animate.min.css'%}">
  <link rel="stylesheet" type="text/css" href="{% static 'assets/css/vendors/custom/sweetalert/sweetalert2.min.css'%}">


  <!-- Plugins css Ends-->
  <!-- Bootstrap css-->
  <link rel="stylesheet" type="text/css" href="{% static 'assets/css/vendors/bootstrap.css'%}">

  <!-- App css-->
  <link rel="stylesheet" type="text/css" href="{% static 'assets/css/style.css'%}">
  <link id="color" rel="stylesheet" href="{% static 'assets/css/color-1.css'%}" media="screen">

  <!-- Responsive css-->
  <link rel="stylesheet" type="text/css" href="{% static 'assets/css/responsive.css'%}">
  <link rel="stylesheet" type="text/css" href="{% static 'assets/css/vendors/custom/custom.css'%}">

  <style>
      body{
        zoom:90%;
      }
    </style>
</head>

<body>
  <!-- tap on top starts-->
  <div class="tap-top"><i data-feather="chevrons-up"></i></div>
  <!-- tap on tap ends-->
  <!-- page-wrapper Start-->
  <div class="page-wrapper default-wrapper" id="pageWrapper">
    <!-- Page Header Start-->
    <div class="page-header">
      <div class="header-wrapper row m-0">
        <form class="form-inline search-full col" action="#" method="get">
          <div class="form-group w-100">
            <div class="Typeahead Typeahead--twitterUsers">
              <div class="u-posRelative">
                <input class="demo-input Typeahead-input form-control-plaintext w-100" type="text"
                  placeholder="Search Cuba .." name="q" title="" autofocus>
                <div class="spinner-border Typeahead-spinner" role="status"><span class="sr-only">Loading...</span>
                </div><i class="close-search" data-feather="x"></i>
              </div>
              <div class="Typeahead-menu"></div>
            </div>
          </div>
        </form>
        <div class="header-logo-wrapper col-auto p-0">

          <div class="logo-wrapper"><a href="index.html"><img class="img-fluid"
                src="{% static 'assets/images/logo/login_logo.png'%}" alt=""></a></div>
          <div class="toggle-sidebar"><i class="status_toggle middle sidebar-toggle" data-feather="align-center"></i>
          </div>
        </div>
        <div class="left-header col horizontal-wrapper ps-0">
          <ul class="horizontal-menu">

            <li class="level-menu outside"><a class="nav-link" href="#!"><i data-feather="inbox"></i><span>Level
                  Menu</span></a>
            </li>
          </ul>
          </li>
          </ul>
        </div>
        <div class="nav-right col-8 pull-right right-header p-0">
          <ul class="nav-menus">
            <li> <span class="header-search"><i data-feather="search"></i></span></li>
            <li>
              <div class="mode"><i class="fa fa-moon-o"></i></div>
            </li>
            <li class="maximize"><a class="text-dark" href="#!" onclick="javascript:toggleFullScreen()"><i
                  data-feather="maximize"></i></a></li>
            <li class="profile-nav onhover-dropdown p-0 me-0">
              <div class="media profile-media"><img class="b-r-10" src="../assets/images/dashboard/profile.jpg" alt="">
                <div class="media-body"><span>Reymark Valdehueza</span>
                  <p class="mb-0 font-roboto">Admin <i class="middle fa fa-angle-down"></i></p>
                </div>
              </div>
              <ul class="profile-dropdown onhover-show-div">
                <li><a href="#"><i data-feather="user"></i><span>Personal Information</span></a></li>
                <li><a href="#"><i data-feather="log-in"> </i><span>Log out</span></a></li>
              </ul>
            </li>
          </ul>
        </div>
        <script class="result-template" type="text/x-handlebars-template">
            <div class="ProfileCard u-cf">                        
            <div class="ProfileCard-avatar"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-airplay m-0"><path d="M5 17H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-1"></path><polygon points="12 15 17 21 7 21 12 15"></polygon></svg></div>
            <div class="ProfileCard-details">
            <div class="ProfileCard-realName">{{name}}</div>
            </div>
            </div>
          </script>
        <script class="empty-template"
          type="text/x-handlebars-template"><div class="EmptyMessage">Your search turned up 0 results. This most likely means the backend is down, yikes!</div></script>
      </div>
    </div>
    <!-- Page Header Ends-->
    <!-- Page Body Start-->
    <div class="page-body-wrapper default-menu default-menu">
      <!-- Page Sidebar Start-->
      <div class="sidebar-wrapper">
        <div>
          <div class="logo-wrapper"><a href="index.html"><img class="img-fluid for-light"
                src="{% static 'assets/images/logo/login_logo.png'%}" alt=""><img class="img-fluid for-dark"
                src="{% static 'assets/images/logo/logo_dark.png'%}" alt=""></a>
                
            <div class="back-btn"><i class="fa fa-angle-left"></i></div>
            <div class="toggle-sidebar"><i class="status_toggle middle sidebar-toggle" data-feather="grid"> </i></div>
          </div>
          <div class="logo-icon-wrapper"><a href="index.html"><img class="img-fluid"
                src="../assets/images/logo/logo-icon.png" alt=""></a></div>
          <nav class="sidebar-main">
            <div class="left-arrow" id="left-arrow"><i data-feather="arrow-left"></i></div>
            <div id="sidebar-menu">
              <ul class="sidebar-links" id="simple-bar">
                <li class="back-btn"><a href="index.html"><img class="img-fluid"
                      src="../assets/images/logo/logo-icon.png" alt=""></a>
                  <div class="mobile-back text-end"><span>Back</span><i class="fa fa-angle-right ps-2"
                      aria-hidden="true"></i></div>
                </li>
                <li class="sidebar-main-title">
                  <div>
                    <h6 class="lan-1">General</h6>
                    <p class="lan-2">Dashboard,widgets & layout.</p>
                  </div>
                </li>
                <li class="sidebar-list">
                  <label class="badge badge-success">2</label><a class="sidebar-link sidebar-title" href="#"><i
                      data-feather="home"></i><span class="lan-3">Dashboard</span></a>
                  <ul class="sidebar-submenu">
                    <li><a class="lan-4" href="index.html">Default</a></li>
                    <li><a class="lan-5" href="dashboard-02.html">Ecommerce</a></li>
                  </ul>
                </li>


                <li class="sidebar-main-title">
                  <div>
                    <h6 class="lan-8">Transaction</h6>
                    <p class="lan-9">Ready to use Apps</p>
                  </div>
                </li>


                <li class="sidebar-list"><a class="sidebar-link sidebar-title link-nav" href="bookmark.html"><i
                      data-feather="user"> </i><span>User</span></a></li>
                <li class="sidebar-list"><a class="sidebar-link sidebar-title link-nav" href="contacts.html"><i
                      data-feather="list"> </i><span>Contacts</span></a></li>
              </ul>
            </div>
            <div class="right-arrow" id="right-arrow"><i data-feather="arrow-right"></i></div>
          </nav>
        </div>
      </div>
      <!-- Page Sidebar Ends-->
      <div class="page-body">
        <div class="container-fluid">
          <div class="page-title">
            <div class="row">
              <div class="col-6">
                <h3>
                  User Information</h3>
              </div>
              <div class="col-6">
                <ol class="breadcrumb">
                  <li class="breadcrumb-item"><a href="index.html"><i data-feather="home"></i></a></li>
                  <li class="breadcrumb-item"> Apps</li>
                  <li class="breadcrumb-item active"> Tasks Board</li>
                </ol>
              </div>
            </div>
          </div>
        </div>
        <!-- Container-fluid starts-->
        <div class="container-fluid jkanban-container">
          <div class="row">

            <div class="col-12">
              <div class="card">
                <div class="card-header">
                  <button class="btn btn-primary" type="button" data-bs-toggle="modal"
                    data-bs-target="#modalRequests" title="btn btn-primary" style="float: right;">Create
                    requests</button>
                  <!-- <button class="btn btn-primary" type="button" data-bs-toggle="modal" data-bs-target="#modalRequests">Vertically centered</button> -->
                  <div class="modal fade" id="modalRequests" tabindex="-1" role="dialog"
                    aria-labelledby="modalRequests" aria-hidden="true">
                    <div class="modal-dialog modal-dialog-centered" role="document">
                      <div class="modal-content">
                        <div class="modal-header">
                          <h5 class="modal-title">Create request</h5>
                          <button class="btn-close" type="button" data-bs-dismiss="modal" aria-label="Close"></button>
                        </div>
                        <form id="createRequests">
                          <div class="modal-body">
                            <!-- <form class="was-validated"> -->

                            <div class="mb-3">
                              <label class="form-label" for="validationTextarea">Title</label>
                              <input type="text" class="form-control" id="title" name="title" placeholder="title here"
                                required="">
                              <div class="invalid-feedback">Please enter a message in the textarea.</div>
                            </div>
                            <div class="mb-3">
                              <label class="form-label" for="validationTextarea">Description</label>
                              <textarea class="form-control" id="description" name="description"
                                placeholder="problem encountered" required=""></textarea>
                              <div class="invalid-feedback">Please enter a message in the textarea.</div>
                            </div>

                            <div class="mb-3">
                              <label class="form-label" for="validationTextarea">Type</label>
                              <select class="form-select" required="" aria-label="select example" id="cat1" name="cat1" onchange="updateList('cat2', this);">
                                <option ></option>
                              </select>
                              <div class="invalid-feedback">Example invalid select feedback</div>
                            </div>
                            <div class="mb-3">
                              <label class="form-label" for="validationTextarea" id="lbl_cat1">Category 1</label>
                              <select class="form-select" required="" aria-label="select example" id="cat2" name="cat2" onchange="updateList('resultData', this);">
                                <option ></option>
                              </select>
                              <div class="invalid-feedback">Example invalid select feedback</div>
                            </div>

                            <div>
                              <label class="form-label" for="validationTextarea">Image (optional)</label>
                              <input class="form-control" type="file" aria-label="file example">
                              <div class="invalid-feedback">Example invalid form file feedback</div>
                            </div>

                          </div>
                          <div class="modal-footer">
                            <div class="left-header col horizontal-wrapper ps-0">
                              <ul class="horizontal-menu">
                                <li class="level-menu outside"><a class="nav-link" href="#!" ><i data-feather="inbox"></i><span id="resultData">Level</span></a>
                                </li>
                              </ul>
                              </li>
                              </ul>
                            </div>
                            <button class="btn btn-primary was-validated" type="submit">Save changes</button>
                            <button class="btn btn-secondary" type="button" data-bs-dismiss="modal">Close</button>
                          </div>
                        </form>
                      </div>
                    </div>
                  </div>
                  <h5>Tasks Board</h5>
                  <p class="mb-0">Accounting Ticketing system</p>
                </div>
                <div class="card-body">
                  <div id="demo2" style="display: flex;"></div>
                  
                </div>
              </div>
            </div>
          </div>
        </div>
        <!-- Container-fluid Ends-->
      </div>
      <!-- footer start-->
      <footer class="footer">
        <div class="container-fluid">
          <div class="row">
            <div class="col-md-12 footer-copyright text-center">
              <p class="mb-0">Copyright 2022 © OUTBOX:TICKETING </p>
            </div>
          </div>
        </div>
      </footer>
    </div>
  </div>
  <!-- latest jquery-->


  <script src="{% static 'assets/js/jquery-3.5.1.min.js'%}"></script>
  <!-- Bootstrap js-->

  <script src="{% static 'assets/js/bootstrap/bootstrap.bundle.min.js'%}"></script>
  <!-- feather icon js-->

  <script src="{% static 'assets/js/icons/feather-icon/feather.min.js'%}"></script>

  <script src="{% static 'assets/js/icons/feather-icon/feather-icon.js'%}"></script>
  <!-- scrollbar js-->

  <script src="{% static 'assets/js/scrollbar/simplebar.js'%}"></script>

  <script src="{% static 'assets/js/scrollbar/custom.js'%}"></script>
  <!-- Sidebar jquery-->

  <script src="{% static 'assets/js/config.js'%}"></script>
  <!-- Plugins JS start-->

  <script src="{% static 'assets/js/sidebar-menu.js'%}"></script>
  <script src="{% static 'assets/js/jkanban/jkanban.js'%}"></script>
  <script src="{% static 'assets/js/jkanban/custom.js'%}"></script>
  <script src="{% static 'assets/js/typeahead/handlebars.js'%}"></script>

  <script src="{% static 'assets/js/typeahead/typeahead.bundle.js'%}"></script>
  <script src="{% static 'assets/js/typeahead/typeahead.custom.js'%}"></script>
  <script src="{% static 'assets/js/typeahead-search/handlebars.js'%}"></script>
  <script src="{% static 'assets/js/typeahead-search/typeahead-custom.js'%}"></script>

  <script src="{% static 'assets/js/sweet-alert/sweetalert2.min.js'%}"></script>
  <script src="{% static 'assets/js/sweet-alert/app.js'%}"></script>
  <script src="{% static 'assets/js/script.js'%}"></script>
  <script src="{% static 'assets/js/theme-customizer/customizer.js'%}"></script>
  <script src="{% static 'assets/js/custom/customize.js'%}"></script>
  <!-- <script src="{% static 'assets/js/custom/custom.js'%}"></script> -->
  

  <script type="text/javascript">

    $('#createRequests').on('submit', function (e) {
      $.ajax({
        data: new FormData(this),
        url: "{% url 'createtask' %}",
        type: 'POST',
        cache: false,
        contentType: false,
        processData: false
      })
        .done(function (data) {
        $('#modalRequests').modal('hide');
        Swal.fire({  
          icon: 'success',
          title: 'Data has been saved',   
          confirmButtonText: `Save`,
          text: 'Good Job!',
      }).then((result) => {  
        location.reload();
      })});
      e.preventDefault();
    });

    //Tasks board
    var kanban2 = new jKanban({
      element: '#demo2',
      gutter:'15px',
      buttonClick  : function (el, boardId) {
        alert(el.innerHTML);
      },
      boards: [{
        'id': '0',
        'title': 'To do',
        'class': 'bg-info',
        'dragTo': ['1'],
        'item': [
          {% for tasking in requestsdata %}
          {% if tasking.status == 0 %}
        {
          'title': `
                <a class="kanban-box" href="#" data-id="{{tasking.id}}"><span class="date" >{{tasking.date_requested}}</span><span class="badge badge-info f-right">medium</span>
                  <h6>{{tasking.title}}</h6>
                  <div class="media"><img class="img-20 me-1 rounded-circle" src="/static/assets/images/user/3.jpg" alt="" data-original-title="" title="">
                    <div class="media-body">
                      <p>{{tasking.description|truncatechars:200}}</p>
                      <p class="f-12">Requested by: <b>Reymark N. Valdehueza</b></p>
                    </div>
                  </div>
                  <div class="d-flex mt-3">
                    <ul class="list">
                      <li><i class="fa fa-comments-o"></i>2</li>
                      <li><i class="fa fa-paperclip"></i>2</li>
                      <li><i class="fa fa-eye"></i></i></li>
                    </ul>
                    <div class="customers">
                      <ul>
                        <li class="d-inline-block me-3">
                          
                        </li>
                        <li class="d-inline-block"><img class="img-20 rounded-circle" src="/static/assets/images/user/1.jpg" alt="" data-original-title="" title=""></li>
                      </ul>
                    </div>
                  </div></a>
            `,
          },{% endif %}{% endfor %}
        ]
      },
    {
      'id': '1',
        'title': 'In Progress',
          'class': 'bg-warning',
            'dragTo': ['0','2'],
              'item': [
              {% for tasking in requestsdata %} 
              {% if tasking.status == 1 %}
              {
                'title': `
                      <a class="kanban-box" href="#" data-id="{{tasking.id}}"><span class="date" >{{tasking.date_requested}}</span><span class="badge badge-danger f-right">Argent</span>
                        <h6>{{tasking.title}}</h6>
                        <div class="media"><img class="img-20 me-1 rounded-circle" src="/static/assets/images/user/3.jpg" alt="" data-original-title="" title="">
                          <div class="media-body">
                            <p>{{tasking.description|truncatechars:200}}</p>
                            <p class="f-12">Requested by: <b>Reymark N. Valdehueza</b></p>
                          </div>
                        </div>
                        <div class="d-flex mt-3">
                          <ul class="list">
                            <li><i class="fa fa-comments-o"></i>2</li>
                            <li><i class="fa fa-paperclip"></i>2</li>
                            <li><i class="fa fa-eye"></i></i></li>
                          </ul>
                          <div class="customers">
                            <ul>
                              <li class="d-inline-block me-3">
                                <p class="f-12">+5</p>
                              </li>
                              <li class="d-inline-block"><img class="img-20 rounded-circle" src="/static/assets/images/user/1.jpg" alt="" data-original-title="" title=""></li> 
                            </ul>
                          </div>
                        </div></a>
                    `,
              },{% endif %}{% endfor %}
              ]
    },
    {
      'id': '2',
        'title': 'Review',
          'class': 'bg-danger',
            'dragTo': ['1','3'],
              'item': [
              {% for tasking in requestsdata %}
              {% if tasking.status == 2 %}
              {
                'title': `
                      <a class="kanban-box" href="#" data-id="{{tasking.id}}"><span class="date" >{{tasking.date_requested}}</span><span class="badge badge-success f-right">Low</span>
                        <h6>{{tasking.title}}</h6>
                        <div class="media"><img class="img-20 me-1 rounded-circle" src="/static/assets/images/user/3.jpg" alt="" data-original-title="" title="">
                          <div class="media-body">
                            <p>{{tasking.description|truncatechars:200}}</p>
                            <p class="f-12">Requested by: <b>Reymark N. Valdehueza</b></p>
                          </div>
                        </div>
                        <div class="d-flex mt-3">
                          <ul class="list">
                            <li><i class="fa fa-comments-o"></i>2</li>
                            <li><i class="fa fa-paperclip"></i>2</li>
                            <li><i class="fa fa-eye"></i></i></li>
                          </ul>
                          <div class="customers">
                            <ul>
                              <li class="d-inline-block me-3">
                                <p class="f-12">+5</p>
                              </li>
                              <li class="d-inline-block"><img class="img-20 rounded-circle" src="/static/assets/images/user/1.jpg" alt="" data-original-title="" title=""></li> 
                            </ul>
                          </div>
                        </div></a>
                    `,
              },{% endif %}{% endfor %}
              ]
    },
    {
      'id': '3',
        'title': 'Done',
          'class': 'bg-success',
            'dragTo': ['2'],
              'item': [
              {% for tasking in requestsdata %}
              {% if tasking.status == 3 %}
              {
                'title': `
                    <a class="kanban-box" href="#" data-id="{{tasking.id}}"><span class="date" >{{tasking.date_requested}}</span><span class="badge badge-danger f-right">Argent</span>
                      <h6>{{tasking.title}}</h6>
                      <div class="media"><img class="img-20 me-1 rounded-circle" src="/static/assets/images/user/3.jpg" alt="" data-original-title="" title="">
                        <div class="media-body">
                          <p>{{tasking.description|truncatechars:200}}</p>
                          <p class="f-12">Requested by: <b>Reymark N. Valdehueza</b></p>
                        </div>
                      </div>
                      <div class="d-flex mt-3">
                        <ul class="list">
                          <li><i class="fa fa-comments-o"></i>2</li>
                          <li><i class="fa fa-paperclip"></i>2</li>
                          <li><i class="fa fa-eye"></i></i></li>
                        </ul>
                        <div class="customers">
                          <ul>
                            <li class="d-inline-block me-3">
                              <p class="f-12">+5</p>
                            </li>
                            <li class="d-inline-block"><img class="img-20 rounded-circle" src="/static/assets/images/user/3.jpg" alt="" data-original-title="" title=""></li>
                            <li class="d-inline-block"><img class="img-20 rounded-circle" src="/static/assets/images/user/1.jpg" alt="" data-original-title="" title=""></li>
                            <li class="d-inline-block"><img class="img-20 rounded-circle" src="/static/assets/images/user/5.jpg" alt="" data-original-title="" title=""></li>
                          </ul>
                        </div>
                      </div></a>
                `,
              },{% endif %}{% endfor %}
              ]
    }],
    dropEl: function (el, target, source, sibling) {

      //control data id if not existed in list
      var source = source.parentElement.getAttribute('data-id');
      var target = target.parentElement.getAttribute('data-id');
      var id = $(el).find('.kanban-box').data('id');

      $.ajax({
        data: {
        id,
        'sources':source,
        'targets':target
      },
        url: "{% url 'updateStatus' %}",
        type: 'POST'
      }).done(function(data){
        console.log("success");
      })
  }});
  </script>



  <!-- login js-->
  <!-- Plugin used-->
</body>

</html>